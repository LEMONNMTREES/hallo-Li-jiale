<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæ—¥å¿«ä¹ï¼æä½³ä¹å°æœ‹å‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            position: relative;
            color: white;
        }
        
        /* é¬¼ç­ä¹‹åˆƒä¸»é¢˜èƒŒæ™¯ - ä½¿ç”¨çº¯CSSå®ç° */
        .demon-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(220, 20, 60, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(30, 144, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(50, 205, 50, 0.1) 0%, transparent 50%);
            z-index: -2;
        }
        
        .pattern-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ff6b6b' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
            z-index: -1;
        }
        
        /* æ˜Ÿç©¹é“é“è§’è‰²emojiä»£æ›¿ */
        .character-float {
            position: absolute;
            font-size: 40px;
            z-index: 1;
            opacity: 0.7;
            animation: floatRandom 8s ease-in-out infinite;
        }
        
        @keyframes floatRandom {
            0%, 100% { 
                transform: translate(0, 0) rotate(0deg); 
            }
            25% { 
                transform: translate(20px, -30px) rotate(5deg); 
            }
            50% { 
                transform: translate(-15px, -15px) rotate(-5deg); 
            }
            75% { 
                transform: translate(10px, -25px) rotate(3deg); 
            }
        }
        
        /* å¼€ç¯‡é¡µé¢ */
        .intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(22, 33, 62, 0.95));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
            text-align: center;
            padding: 20px;
        }
        
        .intro-title {
            color: #ff6b6b;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.7);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                text-shadow: 0 0 30px rgba(255, 107, 107, 0.7);
            }
            50% { 
                transform: scale(1.05);
                text-shadow: 0 0 50px rgba(255, 107, 107, 1);
            }
        }
        
        .intro-subtitle {
            color: #4ecdc4;
            font-size: 1.2em;
            margin-bottom: 40px;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            margin-top: 20px;
            font-weight: bold;
        }
        
        .start-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(255, 107, 107, 0.6);
        }
        
        /* ä¸»å†…å®¹ */
        .main-content {
            display: none;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .birthday-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 40px 30px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            text-align: center;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .birthday-title {
            color: #ffd166;
            font-size: 2.8em;
            margin-bottom: 25px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #ffd166, #ff9a3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .friend-name {
            color: #ff6b6b;
            font-size: 2em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
            animation: glowName 3s ease-in-out infinite;
        }
        
        @keyframes glowName {
            0%, 100% { text-shadow: 0 0 20px rgba(255, 107, 107, 0.5); }
            50% { text-shadow: 0 0 30px rgba(255, 107, 107, 0.8), 0 0 40px rgba(255, 107, 107, 0.3); }
        }
        
        .message {
            font-size: 1.3em;
            line-height: 1.8;
            margin: 30px 0;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .wishes-box {
            background: rgba(255, 249, 230, 0.15);
            border-left: 4px solid #ffd166;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: left;
        }
        
        .wish-item {
            font-size: 1.2em;
            margin: 15px 0;
            padding-left: 10px;
            color: #fff;
        }
        
        .special-wish {
            background: linear-gradient(45deg, rgba(157, 78, 221, 0.2), rgba(0, 187, 249, 0.2));
            color: #9d4edd;
            font-size: 1.5em;
            font-weight: bold;
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid rgba(157, 78, 221, 0.3);
            box-shadow: 0 5px 15px rgba(157, 78, 221, 0.2);
        }
        
        /* å¯ç‚¹å‡»çš„è›‹ç³•æŒ‰é’® */
        .cake-game {
            margin: 40px auto;
            text-align: center;
        }
        
        .cake-container {
            display: inline-block;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .cake-button {
            width: 180px;
            height: 180px;
            background: linear-gradient(135deg, #ff9a3c, #ff6b6b);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            font-size: 4em;
            color: white;
            box-shadow: 
                0 15px 35px rgba(255, 107, 107, 0.4),
                inset 0 5px 15px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .cake-button:hover {
            transform: rotate(5deg) scale(1.05);
        }
        
        .age-number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
            z-index: 2;
        }
        
        .cake-candles {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5em;
        }
        
        .game-hint {
            color: #4ecdc4;
            margin-top: 15px;
            font-size: 1.1em;
        }
        
        /* æ§åˆ¶æŒ‰é’® */
        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
        }
        
        /* éŸ³ä¹æ§åˆ¶ */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 100;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .music-icon {
            font-size: 24px;
            color: #ffd166;
        }
        
        /* ç¤¼ç‚®æ•ˆæœ */
        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 999;
            font-size: 20px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .intro-title { font-size: 2.2em; }
            .birthday-title { font-size: 2.2em; }
            .friend-name { font-size: 1.6em; }
            .message { font-size: 1.1em; }
            .cake-button { 
                width: 150px; 
                height: 150px;
                font-size: 3em;
            }
            .age-number { font-size: 2.5em; }
            .character-float { font-size: 30px; }
        }
        
        @media (max-width: 480px) {
            .intro-title { font-size: 1.8em; }
            .birthday-card { padding: 25px 20px; }
            .control-buttons { flex-direction: column; align-items: center; }
            .action-btn { width: 90%; justify-content: center; }
        }
        
        /* çƒŸèŠ±æ•ˆæœ */
        .firework {
            position: fixed;
            pointer-events: none;
            z-index: 998;
        }
    </style>
</head>
<body>
    <!-- çº¯CSSèƒŒæ™¯ -->
    <div class="demon-background"></div>
    <div class="pattern-overlay"></div>
    
    <!-- æµ®åŠ¨è§’è‰²emoji -->
    <div id="floatingCharacters"></div>
    
    <!-- å¼€ç¯‡é¡µé¢ -->
    <div class="intro-screen" id="introScreen">
        <h1 class="intro-title">ğŸ‚ æä½³ä¹å°æœ‹å‹ ğŸ‚</h1>
        <div style="font-size: 1.8em; margin: 30px 0;">
            <span style="color:#ffd166;">âœ¨</span>
            <span style="color:#4ecdc4;">ç”Ÿ</span>
            <span style="color:#ff6b6b;">æ—¥</span>
            <span style="color:#9d4edd;">å¿«</span>
            <span style="color:#00bbf9;">ä¹</span>
            <span style="color:#ffd166;">âœ¨</span>
        </div>
        <p class="intro-subtitle">ç‚¹å‡»å¼€å§‹æŒ‰é’®ï¼Œæ¥æ”¶æ¥è‡ªäºŒæ¬¡å…ƒçš„ç¥ç¦ï¼</p>
        <button class="start-btn" onclick="startBirthday()">
            ğŸ å¼€å¯ç”Ÿæ—¥æƒŠå–œ ğŸ
        </button>
        <div style="margin-top: 40px; color: rgba(255,255,255,0.6);">
            <p>ğŸ® å†…å«äºŒæ¸¸ç©å®¶ä¸“å±ç¥ç¦</p>
            <p>âœ¨ ç‚¹å‡»äº’åŠ¨æœ‰æƒŠå–œ</p>
        </div>
    </div>
    
    <!-- ä¸»å†…å®¹ -->
    <div class="main-content" id="mainContent">
        <div class="birthday-card">
            <h1 class="birthday-title">Happy Birthday!</h1>
            <div class="friend-name">æä½³ä¹å°æœ‹å‹</div>
            
            <div class="message">
                <p>åœ¨è¿™ä¸ªå±äºä½ çš„ç‰¹åˆ«æ—¥å­é‡Œï¼Œ</p>
                <p>æ„¿æ‰€æœ‰çš„ç¾å¥½éƒ½å¦‚çº¦è€Œè‡³ âœ¨</p>
            </div>
            
            <div class="wishes-box">
                <div class="wish-item">ğŸ¯ æ„¿ä½ å­¦ä¸šè¿›æ­¥ï¼Œå¤©å¤©å‘ä¸Š</div>
                <div class="wish-item">ğŸ’– æ„¿ä½ ç¬‘å£å¸¸å¼€ï¼Œçƒ¦æ¼å…¨æ¶ˆ</div>
                <div class="wish-item">ğŸŒŸ æ„¿ä½ æ¢¦æƒ³æˆçœŸï¼Œå‰ç¨‹ä¼¼é”¦</div>
                <div class="wish-item">ğŸ® æ„¿ä½ æ¸¸æˆè¿èƒœï¼ŒæŠ½å¡å¿…é‡‘</div>
            </div>
            
            <div class="special-wish">
                ğŸ‰ ç¥ä½ äºŒæ¸¸æ°¸è¿œä¸ä¼šå¤§ä¿åº•ï¼ ğŸ‰
            </div>
            
            <!-- è›‹ç³•äº’åŠ¨æ¸¸æˆ -->
            <div class="cake-game">
                <h3 style="color:#ffd166; margin-bottom: 20px;">ğŸ‚ ç‚¹å‡»è›‹ç³•ï¼Œè®©å®ƒé•¿å¤§ ğŸ‚</h3>
                <div class="cake-container" onclick="growCake()">
                    <div class="cake-button" id="cakeButton">
                        <div class="cake-candles" id="candles">ğŸ•¯ï¸ğŸ•¯ï¸ğŸ•¯ï¸</div>
                        <div class="age-number" id="ageNumber">19</div>
                    </div>
                </div>
                <p class="game-hint" id="cakeHint">ç‚¹å‡»è›‹ç³•åº†ç¥ï¼å½“å‰å¤§å°ï¼šæ­£å¸¸</p>
                <p style="color: rgba(255,255,255,0.7); margin-top: 10px; font-size: 0.9em;">
                    ç‚¹å‡»æ¬¡æ•°ï¼š<span id="clickCount">0</span> æ¬¡
                </p>
            </div>
            
            <!-- æ§åˆ¶æŒ‰é’® -->
            <div class="control-buttons">
                <button class="action-btn" onclick="createConfetti()">
                    ğŸ‰ æ’’èŠ±åº†ç¥
                </button>
                <button class="action-btn" onclick="createFireworks()">
                    âœ¨ æ”¾çƒŸèŠ±
                </button>
                <button class="action-btn" onclick="resetCake()">
                    ğŸ”„ é‡ç½®è›‹ç³•
                </button>
                <button class="action-btn" onclick="showSecretMessage()">
                    ğŸ’ ç‰¹åˆ«ç•™è¨€
                </button>
            </div>
            
            <div style="margin-top: 40px; color: rgba(255,255,255,0.8); font-size: 0.9em;">
                <p>ğŸ® æ¥è‡ªä¸€ä½å…³å¿ƒä½ çš„æœ‹å‹</p>
                <p>â­ æ„¿è¿™ä¸ªç”Ÿæ—¥å……æ»¡æ¬¢ç¬‘å’ŒæƒŠå–œ</p>
            </div>
        </div>
    </div>
    
    <!-- éŸ³ä¹æ§åˆ¶ -->
    <div class="music-control" onclick="toggleMusic()">
        <div class="music-icon" id="musicIcon">ğŸµ</div>
    </div>
    
    <!-- éŸ³é¢‘ -->
    <audio id="birthdayMusic" loop>
        <!-- ä½¿ç”¨åœ¨çº¿éŸ³ä¹é“¾æ¥ï¼Œé¿å…æœ¬åœ°æ–‡ä»¶é—®é¢˜ -->
        <source src="https://assets.mixkit.co/music/preview/mixkit-happy-birthday-to-you-443.mp3" type="audio/mpeg">
    </audio>
    
    <!-- çƒŸèŠ±éŸ³æ•ˆ -->
    <audio id="fireworkSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-party-horn-sound-2927.mp3" type="audio/mpeg">
    </audio>

    <script>
        // åˆå§‹åŒ–å˜é‡
        let cakeSize = 180;
        let clickCount = 0;
        let musicPlaying = false;
        let birthdayStarted = false;
        const birthdayMusic = document.getElementById('birthdayMusic');
        const fireworkSound = document.getElementById('fireworkSound');
        
        // è§’è‰²emojiåˆ—è¡¨ï¼ˆæ˜Ÿç©¹é“é“ç›¸å…³ï¼‰
        const characterEmojis = ['ğŸš€', 'ğŸŒŸ', 'â­', 'âœ¨', 'ğŸ®', 'ğŸ•¹ï¸', 'ğŸ¯', 'ğŸ’«', 'ğŸ”®', 'ğŸ‡'];
        const starRailChars = ['ğŸ®', 'ğŸŒŸ', 'âœ¨', 'ğŸ’«', 'ğŸ”®', 'âš¡', 'ğŸ‡', 'ğŸŒŒ', 'ğŸª', 'â˜„ï¸'];
        
        // ç¥ç¦è¯­åˆ—è¡¨
        const birthdayMessages = [
            "ç”Ÿæ—¥å¿«ä¹ï¼æ„¿ä½ æ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ…ï¼",
            "æ–°çš„ä¸€å²ï¼Œæ„¿ä½ æ›´åŠ è€€çœ¼ï¼",
            "ç¥ä½ æŠ½å¡å¿…å‡ºé‡‘ï¼Œåè¿åŒé»„è›‹ï¼",
            "æ„¿ä½ åƒç‚­æ²»éƒä¸€æ ·å‹‡æ•¢ï¼Œåƒç¥¢è±†å­ä¸€æ ·å¯çˆ±ï¼",
            "æ˜Ÿç©¹é“é“ä¹‹æ—…ï¼Œæ„¿ä½ ä¸æ­ªä¸ä¿åº•ï¼",
            "æ„¿ä½ çš„äººç”ŸåƒäºŒæ¬¡å…ƒä¸€æ ·ç²¾å½©ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼Œæˆ‘çš„å¥½æœ‹å‹ï¼",
            "æ„¿æ‰€æœ‰çš„ç¾å¥½éƒ½å¥”å‘ä½ ï¼"
        ];

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        function initPage() {
            createFloatingCharacters();
            preloadAudio();
            
            // è®¾ç½®è§¦æ‘¸äº‹ä»¶ï¼Œè§£å†³ç§»åŠ¨ç«¯ç‚¹å‡»å»¶è¿Ÿ
            document.addEventListener('touchstart', function() {}, {passive: true});
            
            // æ·»åŠ é”®ç›˜æ”¯æŒ
            document.addEventListener('keydown', function(e) {
                if (e.code === 'Space') {
                    if (!birthdayStarted) {
                        startBirthday();
                    } else {
                        createConfetti();
                    }
                }
            });
        }

        // åˆ›å»ºæµ®åŠ¨è§’è‰²
        function createFloatingCharacters() {
            const container = document.getElementById('floatingCharacters');
            container.innerHTML = '';
            
            // åˆ›å»º10ä¸ªæµ®åŠ¨emoji
            for (let i = 0; i < 10; i++) {
                const emoji = document.createElement('div');
                emoji.className = 'character-float';
                
                // éšæœºé€‰æ‹©emoji
                const emojiSet = Math.random() > 0.5 ? characterEmojis : starRailChars;
                emoji.textContent = emojiSet[Math.floor(Math.random() * emojiSet.length)];
                
                // éšæœºä½ç½®
                emoji.style.left = Math.random() * 90 + 'vw';
                emoji.style.top = Math.random() * 90 + 'vh';
                
                // éšæœºåŠ¨ç”»å»¶è¿Ÿ
                emoji.style.animationDelay = Math.random() * 5 + 's';
                emoji.style.animationDuration = (5 + Math.random() * 10) + 's';
                
                container.appendChild(emoji);
            }
        }

        // é¢„åŠ è½½éŸ³é¢‘
        function preloadAudio() {
            // å°è¯•æ’­æ”¾ä¸€ç‚¹ç‚¹æ¥é¢„åŠ è½½ï¼ˆé™éŸ³æ’­æ”¾ï¼‰
            birthdayMusic.volume = 0;
            birthdayMusic.play().then(() => {
                birthdayMusic.pause();
                birthdayMusic.currentTime = 0;
                birthdayMusic.volume = 1;
            }).catch(e => {
                console.log('éŸ³é¢‘é¢„åŠ è½½å¯èƒ½éœ€è¦ç”¨æˆ·äº¤äº’');
            });
        }

        // å¼€å§‹ç”Ÿæ—¥ç¥ç¦
        function startBirthday() {
            birthdayStarted = true;
            const introScreen = document.getElementById('introScreen');
            const mainContent = document.getElementById('mainContent');
            
            // æ’­æ”¾éŸ³ä¹
            playMusic();
            
            // æ˜¾ç¤ºç¤¼ç‚®æ•ˆæœ
            createFireworks();
            setTimeout(createConfetti, 300);
            setTimeout(createFireworks, 600);
            
            // æ˜¾ç¤ºçƒŸèŠ±æ–‡å­—
            showFireworkText('ğŸ‚ ç”Ÿæ—¥å¿«ä¹ï¼ ğŸ‚');
            
            // åˆ‡æ¢é¡µé¢
            introScreen.style.opacity = '0';
            setTimeout(() => {
                introScreen.style.display = 'none';
                mainContent.style.display = 'block';
                
                // å†æ¬¡åº†ç¥
                setTimeout(() => {
                    createConfetti();
                    showFireworkText('æä½³ä¹å°æœ‹å‹ï¼Œç”Ÿæ—¥å¿«ä¹ï¼');
                }, 500);
                
                // è‡ªåŠ¨æ’’èŠ±
                setInterval(() => {
                    if (Math.random() > 0.7) {
                        createSmallConfetti();
                    }
                }, 2000);
                
            }, 1000);
        }

        // æ’­æ”¾éŸ³ä¹
        function playMusic() {
            birthdayMusic.play().then(() => {
                musicPlaying = true;
                updateMusicIcon();
            }).catch(e => {
                console.log('éœ€è¦ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾éŸ³ä¹');
                // æ˜¾ç¤ºæç¤º
                document.body.addEventListener('click', function firstClick() {
                    birthdayMusic.play();
                    musicPlaying = true;
                    updateMusicIcon();
                    document.body.removeEventListener('click', firstClick);
                });
            });
        }

        // åˆ‡æ¢éŸ³ä¹
        function toggleMusic() {
            if (musicPlaying) {
                birthdayMusic.pause();
                musicPlaying = false;
            } else {
                birthdayMusic.play();
                musicPlaying = true;
            }
            updateMusicIcon();
        }

        // æ›´æ–°éŸ³ä¹å›¾æ ‡
        function updateMusicIcon() {
            document.getElementById('musicIcon').textContent = musicPlaying ? 'ğŸµ' : 'ğŸ”‡';
        }

        // åˆ›å»ºç¤¼ç‚®
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#ffd166', '#9d4edd', '#00bbf9'];
            const emojis = ['ğŸ‰', 'âœ¨', 'ğŸŠ', 'ğŸ’–', 'ğŸŒŸ', 'ğŸ¥³', 'ğŸˆ', 'ğŸ'];
            
            for (let i = 0; i < 80; i++) {
                createParticle(colors, emojis, false);
            }
        }

        // åˆ›å»ºå°ç¤¼ç‚®ï¼ˆè‡ªåŠ¨æ’­æ”¾ç”¨ï¼‰
        function createSmallConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#ffd166'];
            const emojis = ['âœ¨', 'ğŸŒŸ', 'ğŸ’«'];
            
            for (let i = 0; i < 20; i++) {
                createParticle(colors, emojis, true);
            }
        }

        // åˆ›å»ºç²’å­
        function createParticle(colors, emojis, isSmall) {
            const particle = document.createElement('div');
            particle.className = 'confetti';
            
            const size = isSmall ? '15px' : '20px';
            
            if (Math.random() > 0.5) {
                // é¢œè‰²æ–¹å—
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.width = size;
                particle.style.height = size;
                particle.style.borderRadius = '50%';
            } else {
                // emoji
                particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                particle.style.fontSize = size;
                particle.style.backgroundColor = 'transparent';
            }
            
            particle.style.left = Math.random() * 100 + 'vw';
            particle.style.top = '-50px';
            particle.style.transform = `rotate(${Math.random() * 360}deg)`;
            
            document.body.appendChild(particle);
            
            // åŠ¨ç”»
            const duration = isSmall ? 1500 : 2000 + Math.random() * 1000;
            const animation = particle.animate([
                { 
                    transform: 'translateY(0) rotate(0deg)', 
                    opacity: 1 
                },
                { 
                    transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 720}deg)`, 
                    opacity: 0 
                }
            ], {
                duration: duration,
                easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
            });
            
            animation.onfinish = () => particle.remove();
        }

        // åˆ›å»ºçƒŸèŠ±
        function createFireworks() {
            // æ’­æ”¾çƒŸèŠ±éŸ³æ•ˆ
            fireworkSound.currentTime = 0;
            fireworkSound.play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾éœ€è¦ç”¨æˆ·äº¤äº’'));
            
            // åˆ›å»ºå¤šä¸ªçƒŸèŠ±
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    createFirework();
                }, i * 200);
            }
        }

        // åˆ›å»ºå•ä¸ªçƒŸèŠ±
        function createFirework() {
            const x = Math.random() * 80 + 10;
            const y = Math.random() * 80 + 10;
            
            // çƒŸèŠ±ä¸­å¿ƒ
            const center = document.createElement('div');
            center.className = 'firework';
            center.style.left = x + 'vw';
            center.style.top = y + 'vh';
            center.style.fontSize = '30px';
            center.textContent = 'âœ¨';
            
            document.body.appendChild(center);
            
            // ä¸­å¿ƒçˆ†ç‚¸æ•ˆæœ
            center.animate([
                { transform: 'scale(0)', opacity: 1 },
                { transform: 'scale(2)', opacity: 0 }
            ], {
                duration: 800,
                easing: 'ease-out'
            });
            
            // åˆ›å»ºçˆ†ç‚¸ç²’å­
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework';
                particle.style.left = x + 'vw';
                particle.style.top = y + 'vh';
                particle.style.color = ['#ff6b6b', '#ffd166', '#4ecdc4'][Math.floor(Math.random() * 3)];
                particle.textContent = 'â€¢';
                particle.style.fontSize = '20px';
                
                document.body.appendChild(particle);
                
                // ç²’å­çˆ†ç‚¸åŠ¨ç”»
                const angle = Math.random() * Math.PI * 2;
                const distance = 50 + Math.random() * 100;
                const dx = Math.cos(angle) * distance;
                const dy = Math.sin(angle) * distance;
                
                particle.animate([
                    { 
                        transform: 'translate(0, 0) scale(1)', 
                        opacity: 1 
                    },
                    { 
                        transform: `translate(${dx}px, ${dy}px) scale(0)`, 
                        opacity: 0 
                    }
                ], {
                    duration: 1000 + Math.random() * 500,
                    easing: 'ease-out'
                }).onfinish = () => particle.remove();
            }
            
            setTimeout(() => center.remove(), 1000);
        }

        // æ˜¾ç¤ºçƒŸèŠ±æ–‡å­—
        function showFireworkText(text) {
            const textEl = document.createElement('div');
            textEl.textContent = text;
            textEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 2em;
                color: #ffd166;
                font-weight: bold;
                text-shadow: 0 0 20px rgba(255, 209, 102, 0.8);
                z-index: 9999;
                pointer-events: none;
                opacity: 0;
                text-align: center;
                white-space: nowrap;
            `;
            
            document.body.appendChild(textEl);
            
            // åŠ¨ç”»
            textEl.animate([
                { opacity: 0, transform: 'translate(-50%, -50%) scale(0.5)' },
                { opacity: 1, transform: 'translate(-50%, -50%) scale(1.2)' },
                { opacity: 0, transform: 'translate(-50%, -50%) scale(1)' }
            ], {
                duration: 2000,
                easing: 'ease-in-out'
            }).onfinish = () => textEl.remove();
        }

        // è›‹ç³•é•¿å¤§
        function growCake() {
            clickCount++;
            document.getElementById('clickCount').textContent = clickCount;
            
            const cakeButton = document.getElementById('cakeButton');
            const ageNumber = document.getElementById('ageNumber');
            const cakeHint = document.getElementById('cakeHint');
            
            // å¢å¤§è›‹ç³•
            cakeSize += 10;
            cakeButton.style.width = cakeSize + 'px';
            cakeButton.style.height = cakeSize + 'px';
            
            // æ›´æ–°æ•°å­—å¤§å°
            const newFontSize = 3 + clickCount * 0.15;
            ageNumber.style.fontSize = newFontSize + 'em';
            
            // æ›´æ–°æç¤º
            let sizeText = 'æ­£å¸¸';
            if (cakeSize > 250) sizeText = 'è¾ƒå¤§';
            if (cakeSize > 350) sizeText = 'è¶…å¤§';
            if (cakeSize > 450) sizeText = 'å·¨å¤§';
            
            cakeHint.textContent = `ç‚¹å‡»è›‹ç³•åº†ç¥ï¼å½“å‰å¤§å°ï¼š${sizeText}ï¼ˆ${cakeSize}pxï¼‰`;
            
            // æ·»åŠ ç‰¹æ•ˆ
            createSmallConfetti();
            
            // æ¯5æ¬¡ç‚¹å‡»æœ‰ç‰¹æ®Šæ•ˆæœ
            if (clickCount % 5 === 0) {
                createFireworks();
                showFireworkText(`ç‚¹å‡» ${clickCount} æ¬¡ï¼`);
                
                // èœ¡çƒ›å˜åŒ–
                const candles = document.getElementById('candles');
                const candleCount = Math.min(Math.floor(clickCount / 5) + 3, 10);
                candles.textContent = 'ğŸ•¯ï¸'.repeat(candleCount);
            }
            
            // æ¯10æ¬¡ç‚¹å‡»æ”¹å˜è›‹ç³•é¢œè‰²
            if (clickCount % 10 === 0) {
                const colors = [
                    'linear-gradient(135deg, #ff6b6b, #ff8e53)',
                    'linear-gradient(135deg, #4ecdc4, #00bbf9)',
                    'linear-gradient(135deg, #9d4edd, #ff6b6b)',
                    'linear-gradient(135deg, #ffd166, #ff9a3c)'
                ];
                cakeButton.style.background = colors[(clickCount / 10) % colors.length];
            }
            
            // è¾¾åˆ°ä¸€å®šå¤§å°åçš„å½©è›‹
            if (cakeSize > 400) {
                ageNumber.textContent = '19++';
                ageNumber.style.color = '#9d4edd';
                ageNumber.style.textShadow = '0 0 20px rgba(157, 78, 221, 0.8)';
                
                if (cakeSize > 500) {
                    cakeButton.innerHTML = '<div style="font-size:0.8em">ğŸ‚ğŸ‰ğŸ’–<br>MAX!</div>';
                    cakeHint.textContent = 'ğŸ‰ è›‹ç³•å·²ç»è¾¾åˆ°æœ€å¤§å°ºå¯¸ï¼ç”Ÿæ—¥å¤§å¿«ä¹ï¼ ğŸ‰';
                    createFireworks();
                }
            }
        }

        // é‡ç½®è›‹ç³•
        function resetCake() {
            cakeSize = 180;
            clickCount = 0;
            
            const cakeButton = document.getElementById('cakeButton');
            const ageNumber = document.getElementById('ageNumber');
            const cakeHint = document.getElementById('cakeHint');
            const candles = document.getElementById('candles');
            
            cakeButton.style.width = cakeSize + 'px';
            cakeButton.style.height = cakeSize + 'px';
            cakeButton.style.background = 'linear-gradient(135deg, #ff9a3c, #ff6b6b)';
            cakeButton.innerHTML = '<div class="cake-candles" id="candles">ğŸ•¯ï¸ğŸ•¯ï¸ğŸ•¯ï¸</div><div class="age-number" id="ageNumber">19</div>';
            
            ageNumber.style.fontSize = '3em';
            ageNumber.style.color = 'white';
            ageNumber.style.textShadow = '3px 3px 6px rgba(0, 0, 0, 0.4)';
            
            candles.textContent = 'ğŸ•¯ï¸ğŸ•¯ï¸ğŸ•¯ï¸';
            cakeHint.textContent = 'ç‚¹å‡»è›‹ç³•åº†ç¥ï¼å½“å‰å¤§å°ï¼šæ­£å¸¸';
            document.getElementById('clickCount').textContent = '0';
            
            createConfetti();
            showFireworkText('è›‹ç³•é‡ç½®ï¼é‡æ–°å¼€å§‹ï¼');
        }

        // æ˜¾ç¤ºç‰¹åˆ«ç•™è¨€
        function showSecretMessage() {
            const message = birthdayMessages[Math.floor(Math.random() * birthdayMessages.length)];
            showFireworkText(message);
            createConfetti();
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.onload = initPage;
        
        // å¾®ä¿¡ä¸­è‡ªåŠ¨æ’­æ”¾éŸ³ä¹çš„å…¼å®¹å¤„ç†
        document.addEventListener('WeixinJSBridgeReady', function() {
            birthdayMusic.play();
            musicPlaying = true;
            updateMusicIcon();
        }, false);

        // è§£å†³ç§»åŠ¨ç«¯ç‚¹å‡»å»¶è¿Ÿ
        if ('ontouchstart' in window) {
            document.documentElement.style.cursor = 'pointer';
        }
    </script>
</body>
</html>
